---
title: "Data Processing"
author: "Erin M. Buchanan"
date: "9/14/2019"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, size="scriptsize")
def.chunk.hook <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$size != "normalsize", paste0("\\", options$size,"\n\n", x, "\n\n \\normalsize"), x)
})
```

## Import Example Data

```{r import_data}
library(dplyr)
##create overall dataset
master <- read.csv("exp_demo/data/example_data_task.csv", stringsAsFactors = F)

##create demographics only data
demos <- master %>% 
  filter(sender == "Demographics Form")

##we are only interested in the real trials
real_trials <- master %>% 
  filter(sender == "Stimulus Real")
```

## Trial Data

Each language will be saved in a separate file with an item specific trial identification number to allow for matching concepts across languages (i.e., cat → katze → gatta). 

Participants are expected to incorrectly answer trials, and these trials will be marked for potential exclusion. Further, computer errors or trials due to missing data (i.e., participant inattentiveness and timeout trials, internet disconnection, computer crashes) will be marked as such in the final data with NA values.

```{r incorrect_trials}
##mark the trials as correct or incorrrect
##could add this to the experiment file so it would be there
##when you downloaded but here's how to code it
real_trials$correct <- real_trials$class_real == real_trials$response

##specifically mark time out or other computer problems
real_trials$correct[real_trials$ended_on == "timeout"] <- NA
```

The response latencies from each participant's session will be z-scored in line with recommendations from Faust, Balota, Spieler, and Ferraro (1999).

```{r z_score}
real_trials_NA <- real_trials %>% 
  filter(is.na(correct)) 

real_trials_NA$Z_RT = NA

real_trials_nonNA <- 
  real_trials %>% 
  group_by(openLabId) %>% 
  filter(!is.na(correct)) %>% 
  mutate(Z_RT = scale(duration))
```

```{r}
real_trials <- bind_rows(real_trials_NA, real_trials_nonNA)

demo_columns <- c("gender", "year", "edu", "language", "openLabId")
real_columns <- c(setdiff(colnames(real_trials), demo_columns), "openLabId")

real_trials_2 <- merge(demos[ , demo_columns ], 
                     real_trials[ , real_columns], 
                     by = "openLabId",
                     all = T)
```

## Item Data

The item file will contain lexical information about all stimuli (length, frequency, orthographic neighborhood, bigram frequency).



The descriptive statistics calculated from the trial level data will then be included: average response latency, average standardized response latency, sample size, standard errors of response latencies, and accuracy rate. For averages and standard errors, the incorrect and missing trials will be excluded.

No data will be excluded for being a potential outlier, however, we will recommend cut off criterion for z-score outliers at 2.5 and 3.0 and will calculate these same statistics with those subsets of trials excluded.

For all real words, the age of acquisition, imageability, concreteness, valence, dominance, arousal, and familiarity values will be indicated because these values do not exist for nonwords. 

## Priming Data

Priming is defined as the subtraction of average z-scored related response latency for an item from the corresponding item in the unrelated condition.

The similarity scores calculated during stimuli selection will be included, as well as other popular measures of similarity if they are available in that language.